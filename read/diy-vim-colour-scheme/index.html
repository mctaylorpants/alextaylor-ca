<!DOCTYPE HTML>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="Nanoc 4.12.2">

    <title>alextaylor.ca - Hacking up a vim colour scheme</title>

    <link rel="stylesheet" href="https://unpkg.com/purecss@2.0.6/build/pure-min.css" integrity="sha384-Uu6IeWbM+gzNVXJcM9XV3SohHtmWE+3VGi496jvgX1jyvDTXfdK+rfZc8C1Aehk5" crossorigin="anonymous">
    <link rel="stylesheet" href="/stylesheet.css">
    <link rel="stylesheet" href="/code-highlighting.css">

    <!-- favicon generated by https://favicon.io/favicon-generator/ -->
    <!-- Font Copyright (c) 2010-2012, Vernon Adams (vern@newtypography.co.uk), with Reserved Font Names "Coda" -->
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">

    <meta property="og:site_name" content="alextaylor.ca" />
    <meta property="og:type" content="article" />

    
      <meta property="og:image" content="https://alextaylor.ca/images/taylormade_og_image.png" />
      <meta property="og:title" content="Hacking up a vim colour scheme" />
      <meta property="og:description" content="For our hackathon this week at Clio, the theme was “purple,” so I thought I’d try my hand at making a colour scheme for vim. I’ve never really messed around with colours in the terminal before – be..." />
      <meta property="og:url" content="https://alextaylor.ca/read/diy-vim-colour-scheme/" />
      <meta name="twitter:card" content="summary_large_image"></meta>
    
  </head>
  <body>
    <div class="pure-g">
      <div class="pure-u-1 header">
        <div class="l-box">
          <h1>
            <a href="/">
              <span class="light">~/</span>taylormade
            </a>
          </h1>
          <hr />
        </div>
      </div>

      <div class="pure-u-1 content">
        <div class="l-box">
          
            <h1>Hacking up a vim colour scheme</h1>
            <p class="post-meta">
              August 19, 2022
            </p>
          

          <p>For our hackathon this week at Clio, the theme was “purple,” so I thought I’d try my hand at making a colour scheme for vim. I’ve never really messed around with colours in the terminal before – beyond the odd highlighted line in a script – so I figured it would be a fun way to learn more about how ANSI colours work and how vim goes about implementing syntax highlighting.</p>

<p>Let’s dive in!</p>

<h2 id="ansi-escape-codes-confounding-programmers-since-1979">
<a href="#ansi-escape-codes-confounding-programmers-since-1979"></a>ANSI escape codes: confounding programmers since 1979</h2>
<p>vim, and other terminal programs, use <a href="https://en.m.wikipedia.org/wiki/ANSI_escape_code">ANSI escape codes</a> to render colours to the terminal. They look like this:</p>

<pre><code>ESC[38;5;9m
</code></pre>

<p>That’s the “escape” character (<code>\e</code> in Ruby), followed by an opening square bracket <code>[</code>. Then comes the code:</p>

<ul>
  <li>
<code>38</code> means “set the foreground colour”;</li>
  <li>
<code>5</code> means “we’re gonna use 8-bit” (you can use <code>2</code> to specify a series of RGB values instead);</li>
  <li>
<code>9</code> means “use colour number 9”, which is red;</li>
  <li>and <code>m</code> means “OK, we’re done - what comes next is real text.”</li>
</ul>

<p>… but we’re not done yet! We need a way to tell the terminal to stop using red and go back to the default colour - otherwise everything would be red ‘til the end of time. To do that, we use a stop code:</p>

<pre><code>ESC[0m
</code></pre>

<p>Putting it all together, it would look something like this:</p>

<pre><code>ESC[38;5;9m hello world! ESC[0m
</code></pre>

<p>… or, in Ruby:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">puts</span> <span class="s2">"</span><span class="se">\e</span><span class="s2">[38;5;9m hello world! </span><span class="se">\e</span><span class="s2">[0m"</span>
</code></pre></div></div>

<p>As for the colours themselves, 8-bit colours can be specified by using the numbers 0 through 255. I’m used to specifying colours with an RGB value or a hex value, so it was definitely not intuitive to select the right colour I needed. <a href="https://en.m.wikipedia.org/wiki/ANSI_escape_code#Colors">There’s a handy table on Wikipedia</a> that lists the colour codes, but for fun I wrote a little Ruby script to output them all for me, because Hackathon!</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Reference: https://en.m.wikipedia.org/wiki/ANSI_escape_code</span>
<span class="k">def</span> <span class="nf">fg</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="n">colour</span><span class="p">)</span>
  <span class="s2">"</span><span class="se">\e</span><span class="s2">[38;5;</span><span class="si">#{</span><span class="n">colour</span><span class="si">}</span><span class="s2">m</span><span class="si">#{</span><span class="n">text</span><span class="si">}</span><span class="se">\e</span><span class="s2">[0m"</span>
<span class="k">end</span>

<span class="k">def</span> <span class="nf">bg</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="n">colour</span><span class="p">)</span>
  <span class="s2">"</span><span class="se">\e</span><span class="s2">[48;5;</span><span class="si">#{</span><span class="n">colour</span><span class="si">}</span><span class="s2">m</span><span class="si">#{</span><span class="n">text</span><span class="si">}</span><span class="se">\e</span><span class="s2">[0m"</span>
<span class="k">end</span>

<span class="p">(</span><span class="mi">0</span><span class="o">..</span><span class="mi">255</span><span class="p">).</span><span class="nf">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">index</span><span class="o">|</span>
  <span class="nb">puts</span> <span class="s2">"</span><span class="si">#{</span><span class="n">index</span><span class="si">}</span><span class="se">\t</span><span class="s2">🎨 </span><span class="si">#{</span><span class="n">bg</span><span class="p">(</span><span class="s2">"hello world!"</span><span class="p">,</span> <span class="n">index</span><span class="p">)</span><span class="si">}</span><span class="s2">"</span>
  <span class="nb">sleep</span> <span class="mf">0.05</span>
<span class="k">end</span>

<span class="p">(</span><span class="mi">0</span><span class="o">..</span><span class="mi">255</span><span class="p">).</span><span class="nf">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">index</span><span class="o">|</span>
  <span class="nb">puts</span> <span class="s2">"</span><span class="si">#{</span><span class="n">index</span><span class="si">}</span><span class="se">\t</span><span class="s2">🎨 </span><span class="si">#{</span><span class="n">fg</span><span class="p">(</span><span class="s2">"hello world!"</span><span class="p">,</span> <span class="n">index</span><span class="p">)</span><span class="si">}</span><span class="s2">"</span>
  <span class="nb">sleep</span> <span class="mf">0.05</span>
<span class="k">end</span>
</code></pre></div></div>

<p><img src="/images/colours-rb.png" alt="" class="pure-img"></p>

<h2 id="syntax-highlighting-in-vim">
<a href="#syntax-highlighting-in-vim"></a>Syntax highlighting in vim</h2>
<p>vim defines a bunch of “highlight groups” that work kind of like CSS classes: any text that belongs to that group will get the same style treatment. So defining your own colour scheme is a matter of telling vim what colours you want for each group.</p>

<pre><code>highlight Normal ctermbg=9 ctermfg=15
</code></pre>

<p>This <code>highlight</code> command will set the “Normal” group to use white text on a red background. “Normal” is the base layer; any text that’s not part of another group will receive this style.</p>

<p>You can run this command at any point in a vim session, but using that for a whole theme would be tedious! There’s a <code>colors</code> folder where the default themes are defined, so that’s where I started hacking on mine - I just made a new <code>.vim</code> file in there. (You can get to the folder by running <code>:e $VIMRUNTIME/colors</code>).</p>

<h2 id="whack-a-mole">
<a href="#whack-a-mole"></a>Whack-a-mole</h2>
<p>So, now I knew how to specify a colour, and how to apply it to some text. Time to figure out how to put a theme together!</p>

<p>The highlight groups aren’t always the most intuitively-named, so it’s tricky figuring out how to change the colour of the thing you’re looking at. For example, the <code>Constant</code> group highlights literals in Ruby – such as numbers, strings and symbols – while the <code>Type</code> group is for <em>actual</em> Ruby constants (which includes class names).</p>

<p>It definitely felt like whack-a-mole at times, because not only was I unfamiliar with the colour codes, I also didn’t know which highlight groups styled each part of the code. I reduced the variables for myself by choosing a group, and highlighting it in <code>200</code> pink so I could see what lit up.</p>

<p>I also wanted a quick way to reload my theme each time I made a change, so I made two little shortcuts:</p>

<pre><code>map &lt;leader&gt;c :source $VIMRUNTIME/colors/test.vim&lt;CR&gt;
map &lt;leader&gt;d :colorscheme solarized&lt;CR&gt;
</code></pre>

<p><code>source</code> will evaluate the contents of that file, so by hitting <code>&lt;leader&gt;c</code> I could load up my new theme. <code>&lt;leader&gt;d</code> would flip back to my current theme, <a href="https://github.com/altercation/vim-colors-solarized">solarized</a>, for comparison. (<code>&lt;leader&gt;</code> is a vim hotkey which can be customized to your liking; I use the apostrophe <code>'</code>). With these two shortcuts in hand, I could quickly compare how my theme was coming along using a test file:</p>

<p><img src="/images/vim-colour-compare.gif" alt="" class="pure-img"></p>

<h2 id="i-purple-you-">
<a href="#i-purple-you-"></a>I purple you 💜</h2>
<p>Since the Hackathon theme was purple, I needed a name that was on-theme. I settled on “borahae”, which is a Korean portmanteau of “bora 보라” (purple), and “saranghae 사랑해”, (“I love you”). So, it roughly translates to “I purple you!” It was coined by a member of the K-pop band <a href="https://ibighit.com/bts/eng/">BTS</a>, who you should all listen to because they’re awesome.</p>

<h2 id="the-finished-product">
<a href="#the-finished-product"></a>The finished product</h2>
<p><a href="https://github.com/mctaylorpants/vim-borahae"><code>vim-borahae</code> is up on Github</a>! I would consider it <em>extremely</em> alpha but it was a fun project to learn a bit more about ANSI colours and customizing vim.</p>

<p><img src="https://user-images.githubusercontent.com/7259082/185664193-6faf62c8-7fa1-4cc5-a97b-73d1bba2c023.png" alt="" class="pure-img"></p>


        </div>
      </div>

      <div class="pure-u-1">
        
          <div class="l-box">
            <hr />

            <p>
              <em>Keep reading:</em>
            </p>

            
              <a href=https://alextaylor.ca/read/practicing-ortholinear/>
                <div class="article-box">
                  ❮ Practicing Ortholinear
                </div>
              </a>
            

            
              <a href=https://alextaylor.ca/read/teach-yourself-something-you-already-know/>
                <div class="article-box" style="text-align: right">
                  Teach yourself something you already know ❯
                </div>
              </a>
            

            <a href="/archive">
              <div class="article-box" style="text-align: center">
                Archive
              </div>
            </a>
          </div>
        

        <div class="l-box">
          <hr />
          <p class="footer">
            &copy; 2024 <strong>Alex Taylor</strong>
          </p>
          <p class="footer">
            <a href="https://github.com/mctaylorpants">github</a>
            &middot;
            <a href="https://www.linkedin.com/in/alexmorgantaylor/">linkedin</a>
            &middot;
            <a href="https://x.com/mctaylorpants">x</a>
            &middot;
            <a rel="me" href="https://ruby.social/@alextaylor">mastodon</a>
          </p>
        </div>
      </div>
    </div>
  </body>
</html>
